pkgname=docura-bin
pkgver=1.0.0
pkgrel=1
pkgdesc="Docura - Modern markdown editor built with Tauri"
arch=('x86_64')
url="https://github.com/WOF-Softwares/Docura"
license=('Apache')
depends=('gtk3' 'webkit2gtk')
provides=('docura')
conflicts=('docura')
options=('!strip')
source=("docura_1.0.0_amd64.deb")
noextract=("${source[@]}")
sha256sums=('SKIP')

package() {
  # Extract .deb (data.tar.* contains the actual files)
  cd "${srcdir}"
  ar x "docura_1.0.0_amd64.deb"
  tar -xf data.tar.* -C "${pkgdir}/"
  
  # Fix permissions
  find "${pkgdir}" -type d -exec chmod 755 {} \;
  find "${pkgdir}/usr/bin" -type f -exec chmod 755 {} \; 2>/dev/null || true
  find "${pkgdir}/usr/share/applications" -type f -exec chmod 644 {} \; 2>/dev/null || true
  find "${pkgdir}/usr/share/icons" -type f -exec chmod 644 {} \; 2>/dev/null || true
  
  # Verify binary exists
  if [[ ! -f "${pkgdir}/usr/bin/docura" ]]; then
    echo "Warning: Binary not found at expected location"
    find "${pkgdir}" -type f -name "docura" || true
  fi
}
